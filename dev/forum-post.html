<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>媒山友｜討論｜發佈文章</title>
    <link rel="stylesheet" href="./css/fa5.14.0all.min.css">
    <link rel="stylesheet" href="./css/fa5.14.0v4.min.css">
    <link rel="stylesheet" href="./css/forum-post.css">
    <link rel="stylesheet" href="./css/footer.css">
    <link rel="stylesheet" href="./css/header.css">
    <!--字體--->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&display=swap">
    
    <script src="./js/header.js" ></script>
    <script src="./js/jquery-3.5.1.js"></script>
    <script src="./js/fa5.14.0all.js"></script><!----go top裡面的箭頭需要用到的js----->
    <script src="./js/vue.js"></script>
    <script src="./js/axios.min.js"></script>
    <script src="./js/sweetalert.min.js"></script>
</head>
<body>

    <header>
        <div id="headerbox">
            <a href="./Frontstageindex.html" class="logo">
                <img class="logo" src="./images/logo/LOGO_white.png" alt="">
            </a> 

            <nav class="menuhover">
                <ul class="menuhover">
                    <li class="bg bg1"></li>
                    <li class="bg bg2"></li>
                    <li class="bg bg3"></li>
                </ul>
            </nav>

            <nav class="menu">
                <ul class="link_list llleft">
                    <li><a class="tour" href="./meet2-0.html"><p>揪團區</p></a></li>
                    <li><a class="forum" href="./forum.html"><p>討論區</p></a></li>
                    <li><a class="product" href="./product.html"><p>商品區</p></a></li>
                </ul>
                <ul class="link_list llright">
                    <li>
                        <a href="./Member_v2.html"><div id="mem_avatar_box"><img id="mem_avatar_img" src=""></div></a>
                    </li>
                    <li><a href="./Member_v2.html"><div id="mem_info_id"></div></a></li>
                    <li><button id="Logout_btn" class="btnB_L_grey"><p>登出</p><div class="bg"><br></div></button></li>
                    <li><a class="member" id="member_jumpTo"><div class="memicon"><div class="membg"></div></div></a></li>
                    <li><a class="cart" href="./shoppingcart.html"><div class="carticon"><span class="add_count_others"></span><div class="cartbg"></div></div></a></li>
                    
                </ul>
            </nav>
            <div id="imagebox">
                <img id="picTour" src="./images/header/tour.png" alt="">
                <img id="picForum" src="./images/header/forum.png" alt="">
                <img id="picProduct" src="./images/header/product.png" alt="">
            </div>

            <div id="greymask"></div>
            <div id="hamburgerBG">
                <div class="ab white"></div>
                <div class="ab yellow1"></div>
                <div class="ab yellow2"></div>
                <div class="ab yellow3"></div>
            </div>
            <button class="hamburger hamburger--collapse" type="button">
                <span class="hamburger-box">
                    <span class="hamburger-inner"></span>
                </span>
            </button>
        </div>
    </header>

    <div id="banner">
        <img src="./images/form_img/banner_03.jpg" alt="">
    </div>

    <main id="post">
        <div id="post-block">
            <div class="ntittle">
                <h2>發表新主題</h2>
            </div>

            <div class="forum_post">
                
                <form id="forum_post_table"  name="forum_post_table" method="post" action="./phpForConnect/forum-post.php" enctype="multipart/form-data">
                    
                    <div class="text">
                        <span>討論文類別</span>
                    </div>

                    <div class="block">
                        <select class="custom_select" name="forum_post_category" id="forum_post_category" >
                            <option value="揪團心得">揪團心得</option>
                            <option value="裝備資訊">裝備資訊</option>
                            <option value="新手專區">新手專區</option>
                            <option value="登山知識">登山知識</option>
                            <option value="公告" disabled>公告</option> <!---管理員用--->
                        </select>
                    </div>

                    <div class="text ">
                        <span>輸入標題</span>
                    </div>

                    <div class="block">
                        <input type="text" name="forum_post_title" id ="forum_post_title" placeholder="請輸入標題" maxlength="20" required>
                    </div>

                    <div class="text">
                        <span>封面圖片</span>
                    </div>

                    <div class="block">
                        <div class="update-img">
                            <!-- <span>+上傳封面圖片</span> -->
                            <input type="file" name="forum_post_image" id="forum_post_image" accept="image/*" multiple="multiple" required>
                        </div>
                    </div>

                    <div class="text">
                        <span>內文</span>
                    </div>

                    <div class="block">
                        <textarea name="forum_post_innertext" id="forum_post_innertext" cols="30" rows="10" placeholder="我想要說...." required></textarea>
                    </div>

                    <div class="post-btnB_XL_yellow">
                        <button class="btnB_XL_yellow"  
                        type="submit" id="forum-post-btn"><p>確認送出</p><div class="bg"></div></button>
                        <!-- onclick="location.href='./forum.html' -->
                    </div>
                </form>

            </div>
        </div>
    </main>

    <!-- -------------------------GO TOP------------------------- -->
    <a href="#" id="gotop">
        <i class="fas fa-arrow-up"></i>
    </a>

    <footer class="footer">
        <div class="footer_logo_block">
            <a href="./FrontstageIndex.html">
                <img src="./images/logo/LOGO_white.png" alt="">
            </a>
            <div class="copyright">Copyright © 2020 Mountain Community.</div>
        </div>
        <div class="footer_info">
            <div class="sevrves_place-serves_tel">
                <div class="place">
                    <div class="f_color1">桃園市中壢區中大路300號</div>
                    <div class="f_color1">工程二館 資策會大樓</div>
                </div>
                <div class="tel">
                    <div class="f_color1">連絡電話</div>
                    <div class="f_color1">(03)425-7387</div>
                </div>
            </div>
            <div class="serves_time-serves_email">
                <div class="time">
                    <div class="f_color1">服務時間</div>
                    <div class="f_color1">週一至週五10:00~17:00</div>
                </div>
                <div class="email">
                    <div class="f_color1">服務信箱</div>
                    <div class="f_color1">tibame@gmail.com</div>
                </div>
            </div>
            <div class="epaper-footer_link">
                <div class="epaper">
                    <div class="etitle f_color1">輸入信箱訂閱電子報</div>
                    <div class="einput">
                        <input type="text" placeholder="Email address">
                        <div class="e_bt f_color1">SUBSCRIBE</e_bt>
                    </div>
                </div>
                <div class="link">
                    <div class="linkup">
                        <div><a href="https://www.cwb.gov.tw/V8/C/" target="_blank">中央氣象局</a></div>
                        <div><a href="https://npm.cpami.gov.tw/" target="_blank">登山證申請</a></div>
                        <div><a href="" target="_blank">網站快速導覽</a></div>
                    </div>
                    <div class="linkdown">
                        <div><a href="" target="_blank">服務條款及隱私權政策</a></div>
                        <div><a href="" target="_blank">會員使用條款</a></div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script type="text/javascript">
        $(function() {
            /* 按下GoTop按鈕時的事件 */
            $('#gotop').click(function(){
                $('html,body').animate({ scrollTop: 0 }, 'slow');   /* 返回到最頂上 */
                return false;
            });
            
            /* 偵測卷軸滑動時，往下滑超過400px就讓GoTop按鈕出現 */
            $(window).scroll(function() {
                if ( $(this).scrollTop() > 400){
                    $('#gotop').fadeIn();
                } else {
                    $('#gotop').fadeOut();
                }
            });
        });
    </script>

    <script>
        var $hamburger = $(".hamburger");
        $hamburger.on("click", function(e) {
            $hamburger.toggleClass("is-active");
            $("#hamburgerBG").toggleClass("on");
            $(".menu").toggleClass("on")
            $(".link_list").toggleClass("on");
            $("#greymask").toggleClass("on");
            setTimeout(function(){
                $("#greymask").toggleClass("show");
            },100)
            setTimeout(function(){
                $("#hamburgerBG").toggleClass("show");
            },150)
            setTimeout(function(){
                $(".menu").toggleClass("show");
            },200)
        });
        $("#greymask").on("click", function(e) {
            $hamburger.toggleClass("is-active");
            $("#hamburgerBG").toggleClass("on");
            $("nav.menu").toggleClass("on")
            $(".link_list").toggleClass("on");
            $("#greymask").toggleClass("on");
            setTimeout(function(){
                $("#greymask").toggleClass("show");
            },100)
            setTimeout(function(){
                $("#hamburgerBG").toggleClass("show");
            },100)
            setTimeout(function(){
                $(".menu").toggleClass("show");
            },200)
        });
    $("#hamburgerBG").on("click", function(e) {
        $hamburger.toggleClass("is-active");
        $("#hamburgerBG").toggleClass("on");
        $("nav.menu").toggleClass("on")
        $(".link_list").toggleClass("on");
        $("#greymask").toggleClass("on");
        setTimeout(function(){
            $("#greymask").toggleClass("show");
        },100)
        setTimeout(function(){
            $("#hamburgerBG").toggleClass("show");
        },100)
        setTimeout(function(){
            $(".menu").toggleClass("show");
        },200)
    });
  </script>

  <script>
    $("a.tour").hover(function(){
        $("div.yellow1").css("opacity","0.9");
        $("li.bg1").css("opacity","0.9");
        $("#picTour").css("top","-25px");
    },function(){
        $("div.yellow1").css("opacity","0");
        $("li.bg1").css("opacity","0");
        $("#picTour").css("top","100%");
    });
    $("a.forum").hover(function(){
        $("div.yellow2").css("opacity","0.9");
        $("li.bg2").css("opacity","0.9");
        $("#picForum").css("top","-25px");
    },function(){
        $("div.yellow2").css("opacity","0");
        $("li.bg2").css("opacity","0");
        $("#picForum").css("top","100%");
    });
    $("a.product").hover(function(){
        $("div.yellow3").css("opacity","0.9");
        $("li.bg3").css("opacity","0.9");
        $("#picProduct").css("top","-25px");
    },function(){
        $("div.yellow3").css("opacity","0");
        $("li.bg3").css("opacity","0");
        $("#picProduct").css("top","100%");
    });
  </script>

<script>
    window.addEventListener("load", function(){
        //..................upFile.onchange ----> 發文加入的code
        document.getElementById("forum_post_image").onchange = function(e){
            let file = e.target.files[0];  //取得file物件
            let reader = new FileReader(); //建立一個reader物件 
            reader.readAsDataURL(file); //利用reader物件將file的內容讀進來
            // reader.onload = function(){ //reader將file內容讀取完畢時
            //     //reader讀到的資料會放到reader.result
            //     document.getElementById("imgPreview").src = reader.result;
            //     console.log(reader.result);
            // }
        }
    })	
</script>
    <!-- -判斷是否為會員- -->
    <script>
        $(document).ready(function() {
            let xhr = new XMLHttpRequest(); //使用XML
            xhr.open("get","./login_v2_LoginInFo.php",true); //用get打開php
            xhr.send(null)

            xhr.onload = function(){
                member = JSON.parse(xhr.responseText); 
                if (member.mem_id){
                    console.log(member.class) // 新column出現後 改欄位名稱 class -> ""
                    if(member.class == 1){
                        $("#forum_post_table option").removeAttr("disabled") //移除option的 disabled(不可點選) 屬性
                    }
                }   else    {
                    window.location.href="./login_v2.html"; // 若沒有取得member.mem_id 將頁面跳轉至登入畫面
                }
            }
        });
    </script>
    <script src="./js/login_v2.js"></script>

</body>
</html>